CREATE DATABASE IF NOT EXISTS sger_db;
USE sger_db;

-- Tabela Cliente
CREATE TABLE IF NOT EXISTS Cliente (
    ID INT AUTO_INCREMENT PRIMARY KEY,
    Nome VARCHAR(100) NOT NULL,
    CNPJ CHAR(14) UNIQUE NOT NULL,
    Endereco VARCHAR(255),
    Telefone VARCHAR(20)
);

-- Tabela Projeto
CREATE TABLE IF NOT EXISTS Projeto (
    ID INT AUTO_INCREMENT PRIMARY KEY,
    Nome VARCHAR(100) NOT NULL,
    Descricao TEXT,
    Data_Inicio DATE,
    Data_Termino DATE,
    Cliente_ID INT NOT NULL,
    FOREIGN KEY (Cliente_ID) REFERENCES Cliente(ID)
);

-- Tabela Recurso
CREATE TABLE IF NOT EXISTS Recurso (
    ID INT AUTO_INCREMENT PRIMARY KEY,
    Nome VARCHAR(100) NOT NULL,
    Tipo VARCHAR(50) NOT NULL
);

-- Tabela Alocacao_Recursos
CREATE TABLE IF NOT EXISTS Alocacao_Recursos (
    ID INT AUTO_INCREMENT PRIMARY KEY,
    Recurso_ID INT NOT NULL,
    Projeto_ID INT NOT NULL,
    Quantidade INT NOT NULL,
    FOREIGN KEY (Recurso_ID) REFERENCES Recurso(ID),
    FOREIGN KEY (Projeto_ID) REFERENCES Projeto(ID)
);

-- Tabela Tarefa
CREATE TABLE IF NOT EXISTS Tarefa (
    ID INT AUTO_INCREMENT PRIMARY KEY,
    Descricao TEXT NOT NULL,
    Data_Inicio DATE,
    Data_Termino DATE,
    Status VARCHAR(20),
    Projeto_ID INT NOT NULL,
    FOREIGN KEY (Projeto_ID) REFERENCES Projeto(ID)
);

-- Tabela Funcionario
CREATE TABLE IF NOT EXISTS Funcionario (
    ID INT AUTO_INCREMENT PRIMARY KEY,
    Nome VARCHAR(100) NOT NULL,
    CPF CHAR(11) UNIQUE NOT NULL,
    Data_Contratacao DATE,
    Telefone VARCHAR(20)
);

-- Tabela Efetivo
CREATE TABLE IF NOT EXISTS Efetivo (
    ID INT PRIMARY KEY,
    Salario DECIMAL(10, 2) NOT NULL,
    Beneficios TEXT,
    FOREIGN KEY (ID) REFERENCES Funcionario(ID)
);

-- Tabela Terceirizado
CREATE TABLE IF NOT EXISTS Terceirizado (
    ID INT PRIMARY KEY,
    Empresa VARCHAR(100) NOT NULL,
    Valor_Hora DECIMAL(10, 2) NOT NULL,
    FOREIGN KEY (ID) REFERENCES Funcionario(ID)
);

-- Tabela Alocacao
CREATE TABLE IF NOT EXISTS Alocacao (
    ID INT AUTO_INCREMENT PRIMARY KEY,
    Funcionario_ID INT NOT NULL,
    Projeto_ID INT NOT NULL,
    Data_Inicio DATE NOT NULL,
    Data_Termino DATE,
    FOREIGN KEY (Funcionario_ID) REFERENCES Funcionario(ID) ON DELETE CASCADE,
    FOREIGN KEY (Projeto_ID) REFERENCES Projeto(ID) ON DELETE CASCADE
);

-- Tabela Departamento
CREATE TABLE IF NOT EXISTS Departamento (
    ID INT AUTO_INCREMENT PRIMARY KEY,
    Nome VARCHAR(100) NOT NULL DEFAULT 'Departamento',
    Responsavel_ID INT,
    FOREIGN KEY (Responsavel_ID) REFERENCES Funcionario(ID)
);

-- Tabela Cliente_Contato
CREATE TABLE IF NOT EXISTS Cliente_Contato (
    ID INT AUTO_INCREMENT PRIMARY KEY,
    Nome VARCHAR(100) NOT NULL,
    Cargo VARCHAR(50),
    Email VARCHAR(150),
    Telefone VARCHAR(20),
    Cliente_ID INT NOT NULL,
    FOREIGN KEY (Cliente_ID) REFERENCES Cliente(ID)
);

