{% extends 'base.html' %}

{% block content %}
<div class="container mt-5">
    <h1 class="text-center">Atribuir Papéis</h1>
    <p class="text-muted text-center">Selecione um usuário e atribua o papel desejado.</p>

    <form method="POST" class="mt-4">
        {% csrf_token %}
        <div class="mb-3">
            <label for="user_id" class="form-label">Usuário</label>
            <select class="form-select" name="user_id" id="user_id" required>
                <option value="" selected disabled>Selecione um usuário...</option>
                {% for user in users %}
                    <option value="{{ user.0 }}">{{ user.1 }}</option>
                {% endfor %}
            </select>
        </div>

        <div class="mb-3">
            <label for="role" class="form-label">Papel</label>
            <select class="form-select" name="role" id="role" required>
                <option value="" selected disabled>Selecione um papel...</option>
                <option value="Admin">Admin</option>
                <option value="Funcionario">Funcionario</option>
                <option value="Cliente">Cliente</option>
            </select>
        </div>

        <button type="submit" class="btn btn-primary w-100">Atribuir Papel</button>
    </form>

    <hr class="my-5">

    <h2 class="text-center">Usuários Registrados</h2>
    <table class="table table-striped mt-4">
        <thead>
            <tr>
                <th>ID</th>
                <th>Nome de Usuário</th>
                <th>Papel Atual</th>
            </tr>
        </thead>
        <tbody>
            {% for user in users %}
                <tr>
                    <td>{{ user.0 }}</td>
                    <td>{{ user.1 }}</td>
                    <td>
                        {% with user.0 as user_id %}
                            {% for role in roles %}
                                {% if role.0 == user_id %}
                                    {{ role.1 }}
                                {% endif %}
                            {% endfor %}
                        {% endwith %}
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
